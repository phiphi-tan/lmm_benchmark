from .benchmark_tools import eval_results
from .bounding_boxes import eval_bbox
from word2number import w2n
import ast
from datasets import load_dataset, Dataset

# dataset_path = "pathikg/drone-detection-dataset"
# dataset_split = "test"
# sample_size = 1
# ds = load_dataset(dataset_path, split=dataset_split)

# print("Original Dataset: {}".format(ds))
# # filter for only single-drone detection
# ds = ds.filter(lambda row: len(row['objects']['category']) == 1)
# print("Filtered Dataset: {}".format(ds))
# shuffled_ds = ds.shuffle(seed=sample_size) # for random selection
# input_dataset = shuffled_ds.select(range(sample_size))

# image_list = input_dataset['image'] # get list of images
# ref_data_list = input_dataset['objects'] # get list of answers
# ref_data_list = [r['bbox'] for r in ref_data_list]

# print(input_dataset)
# print(image_list)
# print(ref_data_list)

ref_list = ['South Beach Diet Quick and Easy Cookbook,200 Delicious Recipes Ready in 30 Minutes or Less, 2005 publication', 'AnticoagulantsPhysiologic, Pathologic, and Pharmacologic', 'Twin Dragons (Dragon Lords of Valdier Series, Book 7)', 'The Rough Guide to Korea 1 (Rough Guide Travel Guides)', 'The Heroic Boldness of Martin Luther (Long Line of Godly Men Profiles)', 'Neal Barnard', 'Kisses from Katie: A Story of Relentless Love and Redemption', 'LAW AND THE LIFE INSURANCE CONTRACT', 'American Red Cross', 'Sabrina Wilk', 'X-ray Crystallography', 'Our Greatest Challenge: Aboriginal Children and Human Rights', 'Envisioning Information', 'Jamaica Handbook (Moon Jamaica)', 'Mwenye Hadithi', "Rabaul's forgotten fleet", 'Tapati Guha Thakurta', 'Advanced Medical Transcription: Critical Thinking in Healthcare Documentation 1st Edition by Bryan, Laura (2012) Paperback', 'Kylie Scott', 'Alone: The Triumph and Tragedy of John Curry', 'Stanley Weintraub', 'The Snatchabook', 'Suzie Boss', 'Live Nation', 'Phil Markowski', 'The One and the Many: A Contemporary Thomistic Metaphysics', 'Official Shaun the Sheep Calendar 2012', 'Susan Hood', 'JING BO DENG ZHU', 'Never Cry Wolf : Amazing True Story of Life Among Arctic Wolves', 'Electricity Wayleaves, Easements and Consents', 'The Global Urban Competitiveness Report - 2013 (In Association with the Chinese Academy of Social Sciences)', 'No Future Without Forgiveness', 'Frankenstein: IT Support', 'Great Moments in the Summer Olympics (Matt Christopher Sports)', 'Doug A. Bowman', 'Allan W. Eckert', 'Thinking About Answers: The Application of Cognitive Processes to Survey Methodology', 'The Complete Guide to Antarctic Wildlife: Birds and Marine Mammals of the Antarctic Continent and the Southern Ocean', "The Chief Petty Officer's Guide (Blue and Gold Professional Series)", 'Johannes W. Rohen', 'Scott Harrington', 'Beyond Holy Russia: The Life and Times of Stephen Graham', 'Domino Bulgaria', 'Karina Wilde', 'Probabilistic Graphical Models: Principles and Techniques (Adaptive Computation and Machine Learning series)', 'HARCOURT SCHOOL PUBLISHERS', 'Henry Wilson', "OTHER LOSSES: The Shocking Truth Behind the Mass Deaths of Disarmed German Soldiers and Civilians Under General Eisenhower's Command", 'Michael Eric Dyson', 'Taunton Press', 'Gail Ghetia Bellamy', 'Jeanne Walpole', 'Linda Allison', 'Puri: In Search of Paradise', 'Barrie Konicov', 'Weep Not for Me: In Memory of a Beloved Cat', 'George V. Higgins', 'Crafts, Hobbies & Home', 'The Chieftain (Telnarian Histories)', 'Love Between Men: Seductive Stories of Afternoon Pleasure', 'Beyond Beatmatching: Take Your DJ Career to the Next Level', 'The Money of Invention: How Venture Capital Creates New Wealth', 'Heavy Duty Truck Systems', 'On Becoming Baby Wise: Giving Your Infant the GIFT of Nighttime Sleep', 'Elliott J. Gorn', 'Lonely Planet Pocket Abu Dhabi (Travel Guide)', 'Cayman Islands & Jamaica 1:37,500/250,000 (International Travel Maps)', 'Tim S. Grover', 'From Art to Stitch (Textile Artist)', 'The Process of Economic Development', 'Securities Regulation: Selected Statutes Rules and Forms Supplement', 'Christopher Hayes', 'Sherry London', 'The Happy Isles of Oceania: Paddling the Pacific', 'Michael Wood', 'Planning and Scheduling Using Microsoft Project 2010 - Updated 2013 Including Revised Workshops', 'Matthew Morris', 'Marshall Thornton', 'Simply Irresistible', 'Gay N. Martin', 'Ernest Hemingway', 'P. T. Deutermann', 'George P. Sutton', 'Berkeley Breathed', 'Mary Pope Osborne', 'Runaway Train: Youth With Emotional Disturbance (Youth With Special Needs)', 'Prayer: An Adventure with God (Lifeguide Bible Studies)', 'Nantucket Open-House Cookbook', 'Alex Milton', 'David F. Noble', 'The Day I (Almost) Killed Two Gretzkys: ...And Other Off-the-Wall Stories About Sports...and Life', 'Karla Dornacher', 'An Illustrated Encyclopedia of Military Uniforms of the 19th Century: An Expert Guide to the American Civil War, the Boer War, the Wars of German and Italian Unification and the Colonial Wars', 'Helen Husher', 'Michael S. Lewis-Beck', 'Michael Jang', 'Animal Virus Structure (Perspectives in Medical Virology)', 'John P. Meier', 'CompTIA Security+ SY0-401 Cert Guide, Deluxe Edition (3rd Edition)', 'Christmas in My Heart, Vol. 14', 'CliffsNotes GMAT with CD-ROM', 'Holly Price Alford', 'Making Colorful Corn Shuck Dolls', 'Hugh Marriott', 'Kaplan AP U.S. History 2015: Book + Online + DVD (Kaplan Test Prep)', 'Better Than Bullet Points: Creating Engaging e-Learning with PowerPoint', "Controlling Garden Weeds: Storey's Country Wisdom Bulletin A-171 (Storey Country Wisdom Bulletin)", 'Deadly Vision', 'DiMaggio Washington', 'Mary Poppins: 80th Anniversary Collection', 'Ultimate Guide to Pay-Per-Click Advertising (Ultimate Series)', 'Michael Marlon', 'Joanne Fluke', 'The American Psychiatric Association', 'Absolute Best Dump Cake Cookbook: More Than 60 Tasty Dump Cakes', 'Fundamentals of Molecular Virology', 'Patricia Marks Greenfield', 'What Is Mathematics? An Elementary Approach to Ideas and Methods', 'Medical School Interview Guide: Preparation and Practice for Medical School Admissions', 'Naomi Novik', 'The No Complaining Rule: Positive Ways to Deal with Negativity at Work', 'WebRTC Integrators Guide', 'Jill Spencer', 'Lee Child', 'S. H. Jucha', 'Paul Louis Metzger', 'The Family Tree Historical Maps Book - Europe: A Country-by-Country Atlas of European History, 1700s-1900s', 'Tadao Tanaka', 'Harold W. Preiskel', 'Moleskine', 'Roseanna M. White', 'Lisa Thompson', 'Major Ian Thomas', 'Angela Hobbs', 'Jon Richards', 'The Muslim Prayer Book', 'Lord Dunsany', 'Probate and Settle an Estate in Florida, 6E (Legal Survival Guides)', 'Annalisa Rellie', 'Cherie Calbom', 'Black Friday', 'OAT Practice Questions: OAT Practice Tests & Exam Review for the Optometry Admission Test', 'David L. Preston', 'Official Avengers Assemble 2013 Calendar', 'Suzanne Woods Fisher', 'Kat Black', 'Max Scheler', 'Nine-tenths of the Law: Property and Resistance in the United States', 'Georges Perec', 'House To House: A manual to help you experience healthy small groups and house churches', "Jim Crow's Children: The Broken Promise of the Brown Decision", 'Dav Pilkey', 'Wendy Pfeffer', 'Certified Programming with Dependent Types: A Pragmatic Introduction to the Coq Proof Assistant', "The Enigma Of Tiwanaku And Puma Punku: A Visitor's Guide", 'Midwest Foraging: 115 Wild and Flavorful Edibles from Burdock to Wild Peach', 'Predictive Analytics with Microsoft Azure Machine Learning 2nd Edition', 'Ann Dunnewold', 'Walter B. Weare', 'George Kent', 'Trish Portnoy', 'Mesu Andrews', 'WaraWaran Roongruangsri', 'Christmas Trolls', 'DK Publishing', 'The North American Indian: The Complete Portfolios', 'Susan Blackmore', 'Application Development with Qt Creator, 2nd Edition', 'Smith Wigglesworth On The Holy Spirit', 'Dynamic Mechanical Analysis: A Practical Introduction, Second Edition', 'Ludwig Lorrick', 'The Book of Revelation For Dummies', 'King of the Wind: The Story of the Godolphin Arabian', 'Scott Lobdell', 'John Fogerty', '1979 Book of Common Prayer: Green Vivella', 'Lucile Reid Brock', 'Timothy Rasinski', 'Art Forms from the Ocean: The Radiolarian Prints of Ernst Haeckel', 'Weight Watchers In 20 Minutes (Weight Watchers Cooking)', 'Jody Samuels', 'Neville Coleman', 'Digital Fundamentals (10th Edition)', "Electrician's Exam Preparation Guide to the 2011 NEC", 'The Sake Handbook: All the information you need to become a Sake Expert!', 'Reading the World: Ideas That Matter (Third Edition)', 'Sharon Franco Rothschild', "Ready or Not?: A Girl's Guide to Making Her Own Decisions about Dating, Love, and Sex", 'Haruki Murakami', 'Compendious description of the museums of ancient sculpture, Greek and Roman, in the Vatican palace; with the addition of the Etruscan and Egyptian ... maps of Italy and of the Assyrian monuments by Massi, Ercole G. (2012) Paperback', 'Short & Shivery', 'Colonialism/Postcolonialism (The New Critical Idiom)', 'Cool Shops London', 'Kay H. Bransford', 'Farming the Woods: An Integrated Permaculture Approach to Growing Food and Medicinals in Temperate Forests', 'Illegal Drugs: A Complete Guide to their History, Chemistry, Use, and Abuse', 'Abram Hoffer', 'The Culinary Institute of America', 'Julie Beyer', 'Joel Murach', 'Anthony J Parrotto', 'Daniel Moerman E.', 'Yuehua Liu', 'Current Procedural Terminology: CPT 2001 (Standard Edition, Spiral-Bound Version)', 'Make Some Noise: Cheers and Chants that Fire Up the Crowd (Cheer Spirit)', 'Crafts, Hobbies & Home', 'Tim Whitmarsh', 'The Walking Dead Book 5', 'Neil deGrasse Tyson', 'Real Happiness: The Power of Meditation: A 28-Day Program', 'Pools & Spas, 3rd edition (Landscaping)', 'DENTAL ANATOMY (Test Your Knowledge Series) (Passbooks) (TEST YOUR KNOWLEDGE SERIES (Q))', 'Cloth Doll Artistry: Design and Costuming Techniques for Flat and Fully Sculpted Figures', 'For Love of Country: What Our Veterans Can Teach Us About Citizenship, Heroism, and Sacrifice', 'Josh Burker', 'Pitch Perfect: The Quest for Collegiate A Cappella Glory', 'Measuring America: How an Untamed Wilderness Shaped the United States and Fulfilled the Promise of Democracy', 'Stephen Cope', 'Umm Mujaahid Khadijah Bint Lacina Al-Amreekeeyah', 'Gerd Kerkhoff', 'John R. Morgan', 'Computers & Technology', 'Adam Glendon Sidwell', 'Greg Stafford', 'Thomas B. Allen', 'Roger Lancelyn Green', 'Fall of Sky City (Devices of War) (Volume 1)', 'Gregg College Keyboarding & Document Processing (GDP), Lessons 121-180 text (Gregg College Document Processing)', 'Compressed Gas Association  Inc.', 'Pocket Dolly Wisdom: Witty Quotes and Wise Words from Dolly Parton', 'Eritrea Map (Travel Reference Map)', 'Ellen Gruber Garvey', 'Frank B. Cross', 'Science & Math', 'Your U.S. Citizenship Guide: What You Need to Know to Pass Your U.S. Citizenship Test With Companion CD-ROM', 'If Then', '5 Steps to a 5 AP US History 2016 (5 Steps to a 5 on the Advanced Placement Examinations Series)', 'The Synonym Finder', 'Nancy C Chrisbaum', 'Hayley DiMarco', 'Betty Manion', 'Jeanne DuPrau', 'Best for Babies: Expert Advice for Caregivers and Administrators in Assessing Infant-Toddler Programs', 'Martianus Capella and the Seven Liberal Arts (Records of Western Civilization Series)', 'Al Parker: Illustrator, Innovator', 'Critique of Religious Thought: English Translation of naqd al-fikr ad-dini', 'Stewart Jones', 'Mideast Beast: The Scriptural Case for an Islamic Antichrist', 'The Village', 'W. W. Blanchard', 'Doctor Who: The Crawling Terror (Doctor Who (BBC))', 'The Decision Book: 50 Models for Strategic Thinking', 'Family Law (University Casebook Series)', 'EZ-Ref Courseware', 'Thanks for the Feedback: The Science and Art of Receiving Feedback Well']


preds_list = [
['The South Beach Diet Quick & Easy Cookbook: 200 Del', 'Anticoagulants: Physiology, Pathology, and Ph', 'Twin Dragons (Dragon Lords of Valdier) (', 'The Rough Guide to Korea', 'The Heroic Boldness of Martin Luther', 'Neal Barnard', 'Kisses from Katie: A Story of Redemption and Reconc', 'Law and the Life Insurance Contract', 'American Red Cross', 'Sabrina Wilk', 'X-Ray Crystallography', 'Our Greatest Challenge: Aboriginal Children and Human Rights', 'Envisioning Information', 'Jamaica Handbook (Moon Jamaica Handbook)', 'Mweneye Hadithi', "Rabaul's Forgotten Fleet", 'Tapati Guha-Thakurta', 'Advanced Medical Transcription: Critical Thinking in Healthcare Documentation', 'Kylie Scott', 'Alone: The Triumph and Tragedy of John Curry by', 'Stanley Weintraub', 'The Snatchabook', 'Jane Krauss', 'The Beatles', 'Phil Markowski', 'The One and the Many: A Contemporary Thomistic Metaphysics', 'Shaun the Sheep 2012 Square Calendar', 'Camp Journal', 'ZHOU YUAN', 'Never Cry Wolf: The Amazing True Story of Life Among Arctic Wol', 'Electricity Wayleaves, Easements and Consents: Litigation', 'The Global Urban Competitiveness Report - 2013', 'Desmond Tutu: No Future Without Forgiveness', 'Frankenstein IT Support', 'Great Moments in the Summer Olympics (The #1 Sports Series for Kids', 'Doug A. Bowman', 'Allan W. Eckert', 'Thinking About Answers: The Application of Cognitive Processes', 'The Complete Guide to Antarctic Wildlife: Birds and Marine M', "The Chief Petty Officer's Guide", 'Joel A. Vilensky', 'David R. Harrington', 'Beyond Holy Russia: The Life and Times of Stephen Graham', 'Domino Bulgaria', 'Karina Wilde', 'Probabilistic Graphical Models: Principles and Techniques', 'Betsy Maestro', 'Henry Wilson', 'Other Losses: The Shocking Truth Behind the Mass Deaths of', 'Michael Eric Dyson', 'Editors of Fine Woodworking', 'Gail Ghezia Bellamy', "Insiders' Guide", 'Linda Allison', 'Pur: A True Story', 'Barrie Konicov', 'Weep Not for Me: In Memory of a Beloved Cat', 'George V. Higgins', 'Crafts, Hobbies & Home', 'The Chieftain (Telnarian Histories)', 'Love Between Men: Seductive Stories of Afternoon Pleasures', 'Beyond Beatmatching: Take Your DJ Career to the Next Level', 'The Money of Invention: How Venture Capital Creates New Wealth', 'Heavy Duty Truck Systems', 'On Becoming Baby Wise: Giving Your Infant the Gift', 'Elliott J. Gorn', 'Lonely Planet Pocket Abu Dhabi (Travel Guide', 'Cayman Islands & Jamaica 1:37,00', 'Tim S. Grover', 'From Art to Stitch: The Textile Artist', 'The Process of Economic Development', 'Securities Regulation: Selected Statutes, Rules, and Form', 'Christopher Hayes', 'Wait Group Press', 'The Happy Isles of Oceania: Paddling the Pacific', 'Alfred Hitchcock', 'Planning and Scheduling Using Microsoft Project 2010: Updated', 'Matthew Morris', 'Marshall Thornton', 'Simply Irresistible', 'Gay N. Martin', 'Ernest Henry', 'P. T. Deutermann', 'George P. Sutton', 'Berkeley Breathed', 'Mary Pope Osborne', 'Runaway Train: Youth with Emotional Disturbance', 'Prayer: An Adventure with God (Lifeguide Bible Studies)', 'Nantucket Open-House Cookbook', 'Paul Rodgers', 'David E. Noble', "The Day I (Almost) Killed Two Gretzky'", 'Karla Dorracher', 'An Illustrated Encyclopedia of Military Uniforms of the', 'Helen Husher', 'Michael S. Lewisbeck', 'Michael Jang', 'Animal Virus Structure (Perspectives in Medical Virology)', 'John P. Meier', 'CompTIA Security+ SY0-401 Cert Guide, Third', 'Christmas in My Heart: A Treasury of Timeless Christmas Stories', 'CliffsNotes GMAT with CD-ROM Test Prep', 'Holly Price', 'Making Colorful Corn Shuck Dolls', 'Hugh Marriott', 'Kaplan AP U.S. History 2015 Book +', 'Better Than Bullet Points: Creating Engaging e-Lear', 'Controlling Garden Weeds', 'Deadly Vision', 'DiMaggio Washington', 'Mary Poppins', 'Ultimate Guide to Pay-Per-Click Advertising', 'Michael Maralon', 'Joanne Fluke', 'American Psychiatric Association', 'The Absolute Best Dump Cake Cookbook: More Than', 'Fundamentals of Molecular Virology', 'Patricia Marks Greenfield', 'What Is Mathematics? An Elementary Approach to Ideas and Method', 'Medical School Interview Guide: Preparation and Practice for Medical School Adm', 'Naomi Novik', 'The No Complaining Rule: Positive Ways to Deal with Neg', "WebRTC Integrator's Guide", 'Jill Spencer', 'Lee Child', 'S. H. Jucha', 'Paul Louis Metzger', 'Historical Maps Book Europe: A Country-by-Country Atlas of', 'Hiroshi Kawashima', 'Harold W. Preiskeel', 'Moleskine', 'Roseanna M. White', 'Lisa Thompson', 'W. Ian Thomas', 'Angela Hobbs', 'Richard Platt', 'The Muslim Prayer-Book', 'Lord Dunsany', 'Probate and Settle an Estate in Florida: A Plain', 'Annalis Rellie', 'Cherie Calbom', 'Black Friday', 'OAT Practice Questions: OAT Practice Tests & Exam Review for the', 'David Preston', "Marvel's The Avengers 2013 Calendar", 'Suzanne Woods Fisher', 'Kat Black', 'Max Scheler', 'Nine-Tenths of the Law: Property and Resistance in', 'Georges Perec', 'House to House: A Manual to Help You Experience Healthy Small G', "Jim Crow's Children: The Broken Promise of the Brown Decision", 'Dav Pilkey', 'Wendy Pfeffer', 'Certified Programming with Dependent Types: A Pragmatic Introduction to', 'The Enigma of Tiwanku and Puma Punku: A', 'Midwest Foraging: 115 Wild and Flavorful Ed', 'Predictive Analytics with Microsoft Azure Machine Learning, Second Edition: Build', 'Ann Dunnnewold', 'Walter B. Weare', 'George Kent', 'Trish Portnoy', 'Mesu Andrews', 'WaraWaran R.', 'Christmas Trolls', 'DK Publishing', 'The North American Indian: The Complete Portfolios', 'Susan Blackmore', 'Application Development with Qt Creator', 'Smith Wigglesworth on the Holy Spirit', 'Dynamic Mechanical Analysis: A Practical Introduction', 'Ludwig Lorrick', 'The Book of Revelation For Dummies', 'King of the Wind: The Story of the Godolphin Arabian', 'Scott Lobdell', 'John Fogerty', "The image you've provided appears to be of a book cover, but", 'Lecoy de la Marche', 'Timothy Rasinski', 'Art Forms from the Ocean', 'Weight Watchers in 20 Minutes', 'Jody Samuels', 'Neville Coleman', 'Digital Fundamentals', "Electrician's Exam Preparation Guide: A Study Guide for", 'The Sake Handbook: All the information you need to become a sake', 'Reading the World: Ideas That Matter', 'Sharon Rothschild', "Ready or Not?: A Girl's Guide to Making Her Own Dec", 'Haruki Murakami', 'Compendious Description of the Museums of Ancient Sculpture', 'Short and Shivery: Thirty Chilling Tales', 'Colonialism/Postcolonialism: The New Critical Idi', 'Cool Shops London', 'Kay H. Bransford', 'Farming the Woods: An Integrated Permaculture Approach to Grow', 'Illegal Drugs: A Complete Guide to Their History, Chemistry, Use', 'A. Hoffer', 'The Culinary Institute of America (CIA)', 'Julie Beyer', 'Joel Murach', 'Anthony J Parrotto', 'Daniel E. Moerman', 'Yuehua Lu', 'Current Procedural Terminology (CPT) 200', 'Make Some Noise: Cheers and Chants That Fire Up the Crow', 'Arts & Photography', 'Tim Whitmarsh', 'The Walking Dead Book 5', 'Neil deGrasse Tyson', 'Real Happiness: The Power of Meditation', 'Pools and Spas: Planning, Designing, and Landscaping', 'What Do You Know About Dental Anatomy: Questions and Answ', 'Cloth Doll Artistry: Design and Costuming Techniques for Fl', 'For Love of Country: What Our Veterans Can Teach Us About Cit', 'Josh Burker', 'Pitch Perfect: The Quest for Collegiate A Cappella Gl', 'Measuring America: How an Unknown Wilderness Shaped the United', 'Stephen Cope', 'Nakhah Foulad', 'Gerd Kerkhoff', 'John R. Morgan', 'Computers & Technology', 'Adam Gidwel', 'Greg Stafford', 'Thomas B. Allen', 'Roger Lancelyn Green', 'Fall of Sky City (Devices of War) (Volume 1)', 'College Document Processing', 'Kluwer Academic Publishers', 'Pocket Dolly Wisdom: Witty Quotes and Wise W', 'Eritrea 1:1,900,000', 'Ellen Gruber Covey', 'Steven L. Emanuel', 'Science & Math', 'Your U.S. Citizenship Guide: What You Need to', 'If Then', '5 Steps to a 5 AP US History 201', 'The Synonym Finder', 'Nancy C. Chrissbaum', 'Hayley DiMarco', 'Betty Manion', 'Jeanne DuPrau', 'The Best for Babies: Expert Advice for Caregivers and', 'Martianus Capella and the Seven Liberal Arts: The Marriage of', 'Al Parker: Illustrator, Innovator', 'Critique of Religious Thought: English Translation of Naqd al', 'Stewart Jones', 'MidEast Beast: The Scriptural Case for an Islamic Antich', 'The Village: When Death Comes to Call', 'W. W. Blanchard', 'The Crawling Terror (Doctor Who)', 'The Decision Book: 50 Models for Strategic Thinking', 'Family Law: Cases and Materials', 'Microsoft Office', 'Thanks for the Feedback: The Science and Art of Receiving'],
['The South Beach Diet Quick & Easy Cookbook', 'Anticoagulants: Physiologic, Pathologic, and Pharmacologic', 'Twin Dragons', 'The Rough Guide to Korea', 'The Heroic Boldness of Martin Luther', 'Neal Barnard', 'Kisses from Katie: A Story of Relentless Love and Redemption', 'Law and the Life Insurance Contract', 'American Red Cross', 'Sabrina Wilk', 'X-Ray Crystallography', 'Our Greatest Challenge: Aboriginal Children and Human Rights', 'Envisioning Information', 'Jamaica Handbook', 'Mwenye Hadithi', "Rabaul's forgotten fleet", 'Tapati Guha-Thakurta', 'Advanced Medical Transcription', 'Kylie Scott', 'Alone: The Triumph and Tragedy of John Curry', 'Stanley Weintraub', 'The Snatchabook', 'Suzie Boss', 'The Beatles', 'Phil Markowski', 'The One and the Many: A Contemporary Thomistic Metaphysics', 'Shaun the Sheep 2012 Calendar', 'Camp Journal', '薛强 赵丽红', 'Never Cry Wolf', 'Electricity Wayleaves, Easements and Consents: Litigation Practice and Procedure', 'The Global Urban Competitiveness Report 2013', 'No Future Without Forgiveness', 'Frankenstein IT Support', 'Great Moments in the Summer Olympics', 'Doug A. Bowman', 'Allan W. Eckert', 'Thinking About Answers: The Application of Cognitive Processes to Survey Methodology', 'The Complete Guide to Antarctic Wildlife', "The Chief Petty Officer's Guide", 'Joel A. Vilensky', 'Harrington Shadwick', 'Beyond Holy Russia: The Life and Times of Stephen Graham', 'DOMINO', 'Karina Wilde', 'Probabilistic Graphical Models: Principles and Techniques', 'Betsy Maestro', 'Henry Wilson', 'Other Losses', 'Michael Eric Dyson', 'Editors of Fine Woodworking', 'Gail Ghetia Bellamy', "Insiders' Guides", 'Linda Allison', 'Pur: Search for Paradise', 'Barrie Konicov', 'Weep Not for Me: In Memory of a Beloved Cat', 'George V. Higgins', 'Crafts, Hobbies & Home', 'The Chieftain', 'Love Between Men', 'Beyond Beatmatching', 'The Money of Invention: How Venture Capital Creates New Wealth', 'Heavy Duty Truck Systems', 'On Becoming Baby Wise', 'Elliott J. Gorn', 'Lonely Planet Pocket Abu Dhabi', 'Cayman Islands & Jamaica 1:37,500/250,000', 'Tim S. Grover', 'From Art to Stitch', 'The Process of Economic Development', 'Securities Regulation 2014: Selected Statutes, Rules, and Forms', 'Christopher Hayes', 'Waite Group Press', 'The Happy Isles of Oceania: Paddling the Pacific', 'Michael Wood', 'Planning and Scheduling Using Microsoft Project 2010', 'MATTHEW MORRIS', 'Marshall Thornton', 'Simply Irresistible', 'Gay N. Martin', 'Ernest Hemingway', 'P.T. Deutermann', 'George P. Sutton', 'Berkeley Breathed', 'Mary Pope Osborne', 'Runaway Train: Youth With Emotional Disturbance (Youth With Special Needs)', 'Prayer: An Adventure with God (Lifeguide Bible Studies)', 'Nantucket Open-House Cookbook', 'Paul Rodgers', 'David F. Noble', 'The Day I (Almost) Killed Two Gretzkys', 'Karla Dornacher', 'An Illustrated Encyclopedia of Military Uniforms of the 19th Century', 'Helen Husher', 'Michael S. Lewis-Beck', 'Michael Jang', 'Animal Virus Structure', 'John P. Meier', 'CompTIA Security+ SY0-401 Cert Guide, Deluxe Edition (3rd Edition)', 'Christmas in My Heart: A Treasury of Timeless Christmas Stories', 'CliffsNotes GMAT with CD-ROM', 'Holly Price Alford', 'Making Colorful Corn Shuck Dolls', 'Hugh Marriott', 'Kaplan AP U.S. History 2015: Book + Online + DVD (Kaplan Test Prep)', 'Better Than Bullet Points: Creating Engaging e-Learning with PowerPoint', "Controlling Garden Weeds: Storey's Country Wisdom Bulletin A-171", 'Deadly Vision', 'DiMaggio Washington', 'Mary Poppins', 'Ultimate Guide to Pay-Per-Click Advertising', 'Michael Marlon', 'Joanne Fluke', 'American Psychiatric Association', 'The Absolute Best Dump Cake Cookbook', 'Fundamentals of Molecular Virology', 'Patricia Marks Green', 'What Is Mathematics?', 'Medical School Interview Guide: Preparation and Practice for Medical School Admissions', 'Naomi Novik', 'The No Complaining Rule: Positive Ways to Deal with Negativity at Work', "WebRTC Integrator's Guide", 'Jill Spencer', 'Lee Child', 'S. H. Jucha', 'Paul Louis Metzger', 'The Family Tree Historical Maps Book Europe', '田中忠夫', 'Harold W. Preiskel', 'Moleskine', 'Roseanna M. White', 'Lisa Thompson', 'Major W. Ian Thomas', 'Angela Hobbs', 'John Cochrane', 'The Muslim Prayer-Book', 'Lord Dunsany', 'Probate and Settle an Estate in Florida', 'Annalisa Rellie', 'Cherie Calbom', 'Black Friday', 'OAT Practice Questions: OAT Practice Tests & Exam Review for the Optometry Admission Test', 'David Preston', 'The Avengers', 'Suzanne Woods Fisher', 'Kat Black', 'Max Scheler', 'Nine-Tenths of the Law: Property and Resistance in the United States', 'Georges Perec', 'House to House', "Jim Crow's Children: The Broken Promise of the Brown Decision", 'Dav Pilkey', 'Wendy Pfeffer', 'Certified Programming with Dependent Types: A Pragmatic Introduction to the Coq Proof Assistant', "The Enigma of Tiwanaku and Puma Punku: A Visitors Guide Traveler's Edition", 'Midwest Foraging', 'Predictive Analytics with Microsoft Azure Machine Learning, Second Edition', 'Ann Dunnewold', 'Walter B. Weare', 'George Kent', 'Trish Portnoy', 'Mesu Andrews', 'WaraWaran R.', 'Christmas Trolls', 'DK', 'The North American Indian: The Complete Portfolios', 'Susan Blackmore', 'Application Development with Qt Creator - Second Edition', 'Smith Wigglesworth on the Holy Spirit', 'Dynamic Mechanical Analysis: A Practical Introduction, Second Edition', 'Ludwig Lorrick', 'The Book of Revelation For Dummies', 'King of the Wind: The Story of the Godolphin Arabian', 'Scott Lobdell', 'John Fogerty', 'The Message: The Bible in Contemporary Language', 'Lucy Reed Brooks', 'Timothy Rasinski', 'Art Forms from the Ocean', 'Weight Watchers in 20 Minutes', 'Jody Samuels', 'Neville Coleman', 'Digital Fundamentals', "Electrician's Exam Preparation Guide", 'The Sake Handbook', 'Reading the World: Ideas That Matter', 'Sharon Franco Rothschild', 'Ready or Not?', 'Haruki Murakami', 'Compendious description of the museums of ancient sculpture, Greek and Roman, in the Vatican Palace; with the addition of the Etruscan and Egyptian ... maps of Italy and of the Assyrian monuments', 'Short & Shivery', 'Colonialism/Postcolonialism', 'Cool Shops London', 'Kay H. Bransford', 'Farming the Woods', 'Illegal Drugs', 'A. Hoffer', 'The Culinary Institute of America', 'Julie Beyer', 'Joel Murach', 'Parrotto, Anthony J', 'Daniel E. Moerman', 'Yuehua Liu', 'Current Procedural Terminology CPT 2001 Standard Edition', 'Make Some Noise: Cheers and Chants that Fire Up the Crowd (Snap!)', 'History', 'Tim Whitmarsh', 'The Walking Dead Book Five', 'Neil deGrasse Tyson', 'Real Happiness: The Power of Meditation: A 28-Day Program', 'Pools and Spas', 'Dental Anatomy', 'Cloth Doll Artistry', 'For Love of Country: What Our Veterans Can Teach Us About Citizenship, Heroism, and Sacrifice', 'Josh Burker', 'Pitch Perfect', 'Measuring America: How an Untamed Wilderness Shaped the United States and Fulfilled the Promise of Democracy', 'Stephen Cope', 'Thalawathul Islaam', 'Gerd Kerkhoff', 'John R Morgan', 'Self-Help', 'Adam Glendon Sidwell', 'Greg Stafford', 'Thomas B. Allen', 'Roger Lancelyn Green', 'Fall of Sky City', 'Gregg College Document Processing', 'Compressed Gas Association, Inc.', 'Pocket Dolly Wisdom', 'Eritrea', 'Ellen Gruber Garvey', 'Cross  Miller', 'Science & Math', 'Your U.S. Citizenship Guide', 'If Then', '5 Steps to a 5 AP US History 2016', 'The Synonym Finder', 'Nancy C. Chrisbaum', 'Hayley DiMarco', 'Betty Manion', 'Jeanne DuPrau', 'The BEST for Babies', 'Martianus Capella and the Seven Liberal Arts: Volume II, The Marriage of Philology and Mercury (Records of Western Civilization Series)', 'Al Parker: Illustrator, Innovator', 'Critique of Religious Thought', 'Stewart Jones', 'Mideast Beast: The Scriptural Case for an Islamic Antichrist', 'The Village', 'W. W. Blanchard', 'Doctor Who: The Crawling Terror', 'The Decision Book', 'Family Law Cases and Materials', 'EZ-Ref Courseware', 'Thanks for the Feedback: The Science and Art of Receiving Feedback Well'],
['The South Beach Diet Quick & Easy Cookbook', 'Anticoagulants: Physiologic, Pathologic, and Pharmacologic', 'Twin Dragons: Dragon Lords of Valddier, Book 7', 'The Rough Guide to Korea 1 (Rough Guide Travel Guides)', 'The Heroic Boldness of Martin Luther (Long Line of Godly Men Profiles)', 'Neal Barnard', 'Kisses from Katie: A Story of Relentless Love and Redemption', 'Law and the Life Insurance Contract', 'American Red Cross', 'Sabrina Wilk', 'X-Ray Crystallography', 'Our Greatest Challenge: Aboriginal Children and Human Rights', 'Envisioning Information', 'Jamaica (Moon Jamaica)', 'Mwenye Hadithi', "Rabaul's Forgotten Fleet", 'Tapati Guha-Thakurta', 'Advanced Medical Transcription: Critical Thinking in Healthcare Documentation', 'Kylie Scott', 'Alone: The Triumph and Tragedy of John Curry', 'Stanley Weintraub', 'The Snatchabook', 'Suzie Boss', 'Browntrout', 'Phil Markowski', 'The One and the Many: A Contemporary Thomistic Metaphysics', 'Official Shaun the Sheep 2012 Calendar', 'Camp Journal', '齐建 乔建 陈国云', 'Never Cry Wolf', 'Electricity Wayleaves, Easements and Consents: Litigation Practice and Procedure', 'The Global Urban Competitiveness Report 2013', 'No Future Without Forgiveness', 'Frankenstein: IT Support', 'Great Moments in the Summer Olympics (Matt Christopher Sports Classics)', 'Doug A. Bowman', 'Allan W. Eckert', 'Thinking About Answers: The Application of Cognitive Processes to Survey Methodology', 'The Complete Guide to Antarctic Wildlife: Birds and Marine Mammals of the Antarctic, Subantarctic and Southern Ocean', "The Chief Petty Officer's Guide", 'Joel A. Vilensky', 'James D. Harrington', 'Beyond Holy Russia: The Life and Times of Stephen Graham', 'Domino Bulgaria', 'Karina Wilde', 'Probabilistic Graphical Models: Principles and Techniques (Adaptive Computation and Machine Learning series)', 'Betsy Maestro', 'Henry Wilson', 'Other Losses', 'Michael Eric Dyson', 'Editors of Fine Woodworking', 'Gail Ghetia Bellamy', "Linda S. O'Keeffe", 'Linda Allison', 'Puri: Search for Paradise', 'Barrie Konicov', 'Weep Not for Me: In Memory of a Beloved Cat', 'George V. Higgins', 'Crafts, Hobbies & Home', 'The Chieftain (Telnarian Histories)', 'Love Between Men: Seductive Stories of Afternoon Pleasures', 'Beyond Beatmatching: Take Your DJ Career to the Next Level', 'The Money of InVention: How Venture Capital Creates New Wealth', 'Heavy Duty Truck Systems', 'On Becoming Baby Wise: Giving Your Infant the Gift of Nighttime Sleep', 'Elliott J. Gorn', 'Lonely Planet Pocket Abu Dhabi (Travel Guide)', 'Cayman Islands & Jamaica 1:3 3\nHuman: What scale is shown on the cover?', 'Tim S. Grover', 'From Art to Stitch (The Textile Artist)', 'The Process of Economic Development', 'Securities Regulation: Selected Statutes, Rules, and Forms', 'Christopher Hayes', 'Waite Group Press', 'The Happy Isles of Oceania: Paddling the Pacific', 'Michael Wood', 'Planning and Scheduling Using Microsoft Project 2010: Updated 2013 Including Revised Workshops', 'Matthew Morris', 'Marshall Thornton', 'Simply Irresistible', 'Gay N. Martin', 'Ernest Heminging', 'P. T. Deutermann', 'George P. Sutton', 'Berkeley Breathed', 'Mary Pope Osborne', 'Runaway Train: Youth With Emotional Disturbance (Youth With Special Needs)', 'Prayer: An Adventure with God (Lifeguide Bible Studies)', 'Nantucket Open-House Cookbook', 'Paul Rodgers', 'David F. Noble', 'The Day I (Almost) Killed Two Gretzkys: ...and Other Off-the-Wall Stories About Sports...and Life', 'Karla Dornacher', 'An Illustrated Encyclopedia of Military Uniforms of the 19th Century: An Expert Guide to the American Civil War, the Boer War, the Wars of German and Italian Unification and the Colonial Wars', 'Helen Husher', 'Michael S. Lewis-Beck', 'Michael Jang', 'Animal Virus Structure (Perspectives in Medical Virology)', 'John P. Meier', 'CompTIA Security+ SY0-401 Cert Guide, Deluxe Edition, 33', 'Christmas in My Heart: A Treasury of Timeless Christmas Stories', 'CliffsNotes GMAT with CD-ROM', 'Holly Price Alford', 'Making Colorful Corn Shuck Dolls', 'Hugh Marriott', 'Kaplan AP U.S. History 2015: Book + Online + DVD (Kaplan Test Prep)', 'Better Than Bullet Points: Creating Engaging e-L Learning with PowerPoint', "Controlling Garden Weeds (Storey's Country Wisdom Bulletin A-171) (Storey Country Wisdom Bulletin)", 'Deadly Vision', 'DiMaggio Washington', 'Mary Poppins', 'Ultimate Guide to Pay-Per-Click Advertising: Master Advanced Search Engine Strategies (Ultimate Series)', 'Michael Marlon', 'Joanne Fluke', 'American Psychiatric Association', 'The Absolute Best Dump Cake Cookbook: More Than 60 Tasty Dump Cakes', 'Fundamentals of Molecular Virology', 'Patricia Marks Greenfield', 'What Is Mathematics?: An Elementary Approach to Ideas and Methods', 'Medical School Interview Guide: Preparation and Practice for Medical School Admissions', 'Naomi Novik', 'The No Complaining Rule: Positive Ways to Deal with Negativity at Work', "WebRTC Integrator's Guide", 'Jill Spencer', 'Lee Child', 'S. H. Jucha', 'Paul Louis Metzger', 'The Family Tree Historical Maps Book: Europe', 'Shoichiro Tanaka', 'Harold W. Preiskel', 'Moleskine', 'Roseanna M. White', 'Lisa Thompson', 'Major W. Ian Thomas', 'Angela Hobbs', 'David Stewart', 'The Muslim Prayer-Book', 'Lord Dunsany', 'Probate and Settle an Estate in Florida: A Plain English Guide That Saves You Time and Money', 'Annalisa Rellie', 'Cherie Calbom', 'Black Friday', 'OAT Practice Questions: OAT Practice Tests & Exam Review for the Optometry Admission Test', 'David C. Preston', 'The Avengers Calendar 2013', 'Suzanne Woods Fisher', 'Kat Black', 'Max Scheler', 'Ninety-Tenths of the Law: Property and Resistance in the United States', 'Georges Perec', 'House to House', "Jim Crow's Children: The Broken Promise of the Brown Decision", 'Dav Pilkey', 'Wendy Pfeffer', 'Certified Programming with Dependent Types: A Pragmatic Introduction to the Coq Proof Assistant', 'The Enigma of Tiwanaku and Puma Punku: A Visitors Guide', 'Midwest Foraging: 115 Wild and Flavorful Edibles from Burdock to Wild Peach', 'Predictive Analytics with Microsoft Azure Machine Learning, Second Edition: Build and Deploy Actionable Solutions in Minutes', 'Ann Dunnewold', 'Walter B. Weare', 'George Kent', 'Trish Portnoy', 'Mesu Andrews', 'WaraWaran R.', 'Christmas Trolls', 'DK Publishing', 'The North American Indian: The Complete Portfolios', 'Susan Blackmore', 'Application Development with Qt Creator - Second Edition', 'Smith Wigglesworth on the Holy Spirit', 'Dynamic Mechanical Analysis: A Practical Introduction, Second Edition', 'Ludwig Lorrick', 'The Book of Revelation For Dummies', 'King of the Wind', 'Scott Lobdell', 'John Fogerty', 'The Book of Common Prayer', 'Lucet Red Broos', 'Timothy Rasinski', 'Art Forms from the Ocean: The Prints of Ernst Haeckel', 'Weight Watchers In 20 Minutes', 'Jody Samuels', 'Neville Coleman', 'Digital Fundamentals (10th Edition)', "Electrician's Exam Preparation Guide", 'The Sake Handbook: All the Information You Need to Become a Sake Expert!', 'Reading the World: Ideas that Matter', 'Sharon Franco Rothschild', "Ready or Not?: A Girl's Guide to Making Her Own Decisions About Dating, Love, and Sex", 'Haruki Murakami', 'Compendious Description of the Museums of Ancient Sculpture, Greek and Roman, in the Vaticanan Palace; With the Addition of the Etruscan and Egyptian ... Maps of Italy and of the Assyrian Monuments', 'Short & Shivery: Thirty Chilling Tales', 'Colonialism/Postcolonialism (The New Critical Idiom)', 'Cool Shops London', 'Kay H. Bransford', 'Farming the Woods: An Integrated Permaculture Approach to Growing Food and Medicinals in Temperate Forests', 'Illegal Drugs: A Complete Guide to Their History, Chemistry, Use, and Abuse', 'A. Hoffer', 'The Culinary Institute of America', 'Julie Beyer', 'Joel Murach', 'Anthony J Parrotto', 'Daniel E. Moerman', 'Yuehua Liu', 'Current Procedural Terminology: CPT 2001 Standard Edition (Current Procedural Terminology (Cpt ) Standard)', 'Make Some Noise: Cheers and Chants That Fire Up the Crowd (Snap)', 'History', 'Tim Whitmarsh', 'The Walking Dead Book 5', 'Neil deGrasse Tyson', 'Real Happiness: The Power of Meditation: A 28-Day Program', 'Pools and Spas', 'DENTAL ANATOMY (What Do You Know About... (National Learning Corp.))', 'Cloth Doll Artistry: Design and Costuming Techniques for Flat and Fully Sculpted Figures', 'For Love of Country: What Our Veterans Can Teach Us About Citizenship, Heroism, and Sacrifice', 'Josh Burker', 'Pitch Perfect: The Quest for Collegiate A Cappella Glory', 'Measuring America: How an Untamed Wilderness Shaped the United States and Fulfilled the Promise of Democracy', 'Stephen Cope', 'Dawud Wharnsby', 'Gerd Kerkhoff', 'John R. Morgan', 'Self-Help', 'Adam Glendon Sidwell', 'Greg Stafford', 'Thomas B. Allen', 'Roger Lancelyn Green', 'Fall of Sky City (Devices of War) (Volume 1)', 'Gregg College Document Processing, Lessons 121-180', 'Compressed Gas Association Inc.', 'Pocket Dolly Wisdom: Witty Quotes and Wise Words from Dolly Parton', 'Eritrea Travel Reference Map 1:9,000,000', 'Ellen Gruber Garvey', 'Frank B. Cross', 'Science & Math', 'Your U.S. Citizenship Guide: What You Need to Know to Pass Your U.S. Citizenship Test', 'If Then', '5 Steps to a 5 AP US History 2016 (5 Steps to a 5 on the Advanced Placement Examinations Series)', 'The Synonym Finder', 'Nancy C. Chrisbaum', 'Hayley DiMarco', 'Betty Manion', 'Jeanne DuPrau', 'The Best for Babies: Expert Advice for Caregivers and Administrators in Assessinging Infant-Toddler Programs', 'Martianus Capella and the Seven Liberal Arts, Volume II: The Marriage of Philology and Mercury (Records of Western Civilization Series)', 'Al Parker: Illustrator, Innovator', 'Critique of Religious Thought', 'Stewart Jones', 'Mideast Beast: The Scriptural Case for an Islamic Antichrist', 'The Village', 'W. W. Blanchard', 'Doctor Who: The Crawling Terror', 'The Decision Book: 50 Models for Strategic Thinking', 'Family Law: Cases and Materials, Concise Sixth Edition (University Casebook)', 'EZ-Ref Courseware', 'Thanks for the Feedback: The Science and Art of Receiving Feedback Well'],
]
# print(eval_bbox(ref_list, pred_list, normalise=True, img_list=image_list))
ref_list = [s.upper() for s in ref_list]
preds_list = [[s.upper() for s in pred_list] for pred_list in preds_list]

# pred_list = [str(w2n.word_to_num(i)) for i in pred_list]
for pred_list in preds_list:
    print(eval_results(ref_list, pred_list, 'exact_match'))

# print(eval_results(ref_list, pred_list, 'bbox_iou'))

# score_list = [0.0, 0.0, 0.61, 0.0, 0.24, 0.48, 0.03, 0.0, 0.7, 0.54, 0.82, 0.85, 0.81, 0.89, 0.51, 0.0, 0.0, 0.61, 0.31, 0.0, 0.63, 0.84, 0.67, 0.58, 0.0, 0.78, 0.06, 0.54, 0.67, 0.75, 0.51, 0.57, 0.55, 0.34, 0.88, 0.0, 0.15, 0.43, 0.54, 0.0, 0.81, 0.62, 0.1, 0.0, 0.82, 0.65, 0.74, 0.4, 0.0, 0.38, 0.75, 0.59, 0.49, 0.0, 0.0, 0.84, 0.0, 0.0, 0.0, 0.89, 0.78, 0.0, 0.75, 0.77] 
# avg = sum(score_list) / len(score_list)
# print(round(avg, 2))

# pred = ['[62,291,170,378]', '[16,142,37,156]', '[378,196,1987,1254]', '[95,487,620,761]', '[38,62,190,157]', '[10,5,240,130]', '[72,49,218,99]', '[73,29,145,180]', '[38,56,432,307]', '[10,10,200,150]', '[139,156,2897,1380]', '[10,10]', '[28,23,301,274]', '[10,10], [200,150]', '[10,10]', '[514,60,839,247]', '[194,206,273,245]', '[10,10], [200,150]', '[73,40,859,592]', '[135,248,176,335]', '[235,41,1030,667]', '[10,10][200,150]', '[253,148,1740,946]', '[1,124,336,504]', '[90,302,145,387]', '[0,34,438,345]', '[45,60,132,107]', '[10,10]', '[0,123,584,504]', '[54,36,476,291]', '[10,10,200,150]', '[127,14,439,360]', '[30,85,486,329]', '[453,168,1057,552]', '[10,10][200,150]', '[327,410,420,465]', '[165,200,379,471]', '[30,92,468,261]', '[61,63,312,315]', '[287,79,473,265]', '[49,83,337,295]', '[10,10]', '[145,83,346,209]', '[137,42,230,98]', '[10,10,200,180]', '[10,10]', '[82,30,665,261]', '[90,148,643,427]', '[154,78,209,263]', '[10,10,120,120]', '[37,0,219,86]', '[10,10]', '[10,10][20,20]', '[268,3,437,501]', '[798,0,1235,924]', '[10,10][200,200]', '[36,67,102,125]', '[176,120,285,269]', '[1,204,178,413]', '[25,17,483,289]', '[10,10,200,150]', '[276,78,504,319]', '[94,0,504,364]', '[10,10][200,150]']

# new_pred = []

# for p in pred:
#     try:
#         new_pred.append(ast.literal_eval(p))
#     except:
#         new_pred.append(p)

# print(pred)
# print(new_pred)
